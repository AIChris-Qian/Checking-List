# 概率与统计
  by Chen Qian

------------------------------

**排列组合**    
------------------------------
 
    排列：        从m个元素中选出n个元素进行排列 (不放回)   A(m,n) = C(m,n) * A(n,n)  
    重复排列：    从m个元素中选出n个元素进行排列 (有放回)   m^n  
    组合：        从m个元素中选出n个元素 (不放回)   C(m,n)
    重复组合：    从m个元素中选出n个元素 (有放回)   C(m-1+n,n) 
 
1.  特殊元素 + 特殊位置

2.  相邻元素捆绑

3.  不相邻元素插空

4.  环排问题线排方法

5.  小集体问题先整体后局部

6.  元素相同隔板方法

7.  平均分组分堆方法


------------------------------

**1. `[ 导论 ]`**    
------------------------------

#### 1.1 统计及其应用领域
   
    数据分析 = 描述统计 + 推断统计

#### 1.2 统计数据类型
     
    计量尺度：分类数据 / 顺序数据 / 数值型数据

#### 1.3 统计中的几个基本概念
   
    参数：描述总体特征
    总体平均 / 总体标准差 / 总体比例
    
    统计量：描述样本特征（z统计量 / t统计量 / x^2统计量 / F统计量）
    样本平均 / 样本标准差 / 样本比例
 
------------------------------ 


**2. `[ 数据的搜集 ]`**    
------------------------------

#### 2.1 数据的来源
   
    间接来源：二手资料
    直接来源：通过调查或实验得到的一手资料


------------------------------


**3. `[ 数据的图表展示 ]`**    
------------------------------

#### 3.1 数据预处理
    
    审核 / 筛选 / 排序 / 数据透视表

#### 3.2 品质数据的整理与展示
    
    分类数据的图示：
                  (1) 条形图
                  (2) 饼状图
                  (3) 环形图
                  
#### 3.3 数值型数据的整理与展示
    
    数值型数据的图示：
                    (1) 分组数据：直方图
                    (2) 未分组数据：茎叶图 / 箱线图
                    (3) 时间序列数据：线图
                    (4) 多变量数据：散点图 / 气泡图 / 雷达图


------------------------------


**4. `[ 数据的概括性度量 ]`**    
------------------------------

#### 4.1 集中趋势的度量
   一组数据向某一中心值靠拢的程度
   
    分类数据：众数
    顺序数据：中位数 / 四分位数
    数值型数据：平均数（简单平均数 / 加权平均数）
               几何平均数
   
   （1）众数 / 中位数 / 平均数的关系
     
     平均数 = 中位数 = 众数    对称分布
     平均数 < 中位数 < 众数    左偏分布
     平均数 > 中位数 > 众数    右偏分布
     
   （2）特点与应用场合
      
      对称分布：考虑平均数
      偏态分布：考虑中位数 / 众数

#### 4.2 离散程度的度量
   各变量远离中心值的程度
   
    分类数据：异众比率
    顺序数据：四分位差
    数值型数据：极差 / 平均差 / 方差 / 相对位置的度量：
                                                   (1) 标准分数
                                                   (2) 经验法则（数据对称分布）
                                                   (3) 切比雪夫不等式（数据非对称分布）
    相对离散程度：离散系数（比较不同样本）
               
#### 4.3 偏态与峰态的度量
   偏态：数据分布对称性的测度
     
     数据对称分布   偏态系数为0
     偏态系数 > 0   正偏或右偏
     偏态系数 < 0   负偏或左偏
   
   峰态：数据分布平峰或尖峰程度的测度
   
     标准正态分布   峰态系数为0
     峰态系数 > 0   尖峰分布
     峰态系数 < 0   扁平分布



------------------------------


**5. `[ 概率与概率分布 ]`**    
------------------------------

#### 5.1 集中趋势的度量
   随机事件 / 必然事件 / 不可能事件
   
    基本事件：一次试验一次简单事件
    空间样本：所有简单事件之和
      
#### 5.2 概率的性质与运算法则
   加法法则 / 条件概率 / 独立性
     
     不独立   互斥 / 不互斥       独立    不互斥
     互斥     不独立             不互斥   独立 / 不独立 
 
#### 5.3 离散型随机变量及其分布
   随机变量：随机试验的结果
   
   两种随机变量：离散型 / 连续型（是否可数）
   
   概率分布 / 期望 / 方差
    
    二项分布： x ~ B(n,p)  E(X) = np   Var(X) = np(1-p)
    泊松分布： E(X) = λ   Var(X) = λ
    
   `n → ∞`， `p → 0`，二项分布近似等于泊松分布。
     
     效果良好：p ≤ 0.25，n > 20，np ≤ 5

#### 5.4 连续型随机变量及其分布

   概率分布 / 期望 / 方差
    
    均匀分布： E(X) = (a+b)/2   Var(X) = (b-a)^2/12
    指数分布： E(X) = 1/λ   Var(X) = 1/λ^2
    正态分布： x ~ N(μ,σ^2)  E(X) = μ   Var(X) = σ^2
              σ 较大，曲线平缓；σ 较小，曲线陡峭。
    
   二项分布的正态近似
    
    二项分布近似服从正态分布


------------------------------


**6. `[ 统计量及其抽样分布 ]`**    
------------------------------

#### 6.1 统计量
  `(X1，.... Xn)`从总体 `X` 中取出样本量为 `n` 的一个样本。`T(X1，X2，....Xn)` 是一个统计量。
  
    统计量：样本的一个函数

#### 6.2 关于分布的几个概念
   抽象分布：总体是正态的情况下
      
    X^2分布 / t分布 / F分布
   
   渐进分布：`n → ∞`，统计量 `T` 的极限分布。
    
    中心极限定理：样本均值的渐进分布

#### 6.3 由正态分布导出的几个重要分布
   
   `x^2`分布
   
    x ~ N(0,1)  ∑xi^2 服从自由度为 n 的 x^2分布
    
   `t`分布
    
    x ~ N(0,1)   Y ~ x^2(n)   X 与 Y 独立   t = X/√￣(Y/n)
    
   `F`分布
   
    Y 与 Z 独立   Y ~ x^2(m)   Y ~ x^2(n)   X = (Y/m)/(Z/n)   X ~ F(m,n) 
    
    
#### 6.4 样本均值的分布与中心极限定理
  
   中心极限定理：
    
    总体样本分布为正态分布 N(μ,σ^2)，抽取样本 n，n → ∞，样本均值分布 N(μ,σ^2/n)


#### 6.5 样本比例的抽样分布
  
   样本大小为 `n`，具有某一特征个体为 `X`，样本比例 `p = X/n`，`p` 估计总体比例 `π`
    
    二项分布的正态近似，p ~ N(π,(π(1-π))/n)


#### 6.6 两个样本平均值之差的分布
  
   `X1均`：`x1 ~ N(μ1,σ1^2)` 一个容量为 `n1` 的样本均值
   
   `X2均`：`x2 ~ N(μ2,σ2^2)` 一个容量为 `n2` 的样本均值

    E(X1均 - X2均) = E(X1均) - E(X2均) = μ1 - μ2         Var(X1均 - X2均) = Var(X1均) + Var(X2均) = σ1^2/n1 + σ2^2/n2
   
   `n1 ≥ 30  n2 ≥ 30`  不管总体分布如何都可用正态分布近似
    
    p1 - p2 = X1/n1 - X2/n2 =  π1 - π2    E(p1 - p2) = π1 - π2      Var(p1 - p2) = π1(1-π1))/n1 + π2(1-π2))/n2 
   

#### 6.7 关于样本方差的分布
  
   `x ~ N(μ,σ^2)` 
   
    样本方差 s^2分布：(n-1)s^2/σ^2 ~ X^2(n-1)
   
   `X1 ~ N(μ1,σ1^2)`   `Y1 ~ N(μ2,σ2^2)`    
      
    (S1^2/σ1^2)/(S2^2/σ2^2) ~ F(n1-1,n2-1)   


------------------------------



**7. `[ 参数估计 ]`**    
------------------------------

#### 7.1 参数估计的基本原理
  
  用样本统计量去估计总体参数    总体参数 `θ`    统计量 `θ~` 
   
    估计量：估计总体参数的统计量   估计值：具体样本计算出来的估计量
  
  参数估计：点估计 / 区间估计
    
    点估计：θ~ 某个值直接作为 θ 的估计值
    区间估计：点估计的基础上，总体参数估计的一个区间范围
  
  置信区间：总体参数的估计区间   置信水平：包含总体参数真值的个数  `1-α`
    
    样本量一定，置信水平越大，置信区间越宽。
    置信水平一定，样本量越大，置信区间越窄。
    
  评价估计量的标准：无偏性 / 有效性 / 一致性
  
#### 7.2 一个总数参数的区间估计
    
   总体均值的区间估计：
                     
    (1) 正态总体，方差 σ 已知；非正态分布，大样本
    (2) 正态总体，方差 σ 未知；非正态分布，大样本
    (3) 正态总体，方差 σ 已知，小样本
    (4) 正态总体，方差 σ 未知，小样本
   
   总体比例的区间估计：
   
    (1) 大样本，实际 π 已知
    (2) 大样本，实际 π 已知
    
   总体方差的区间估计：
   
     x^2(1-α/2) ≤ x^2 ≤  x^2(α/2)    (n-1)s^2/σ^2 ~ X^2(n-1)   
    
#### 7.3 两个总数参数的区间估计
       
   
   总体均值之差  `μ1 - μ2` ：
   
    【1】独立样本  (1) 大样本的估计
                      正态总体 / 非正态总体，大样本：
                                                  σ1 / σ2 已知
                                                  σ1 / σ2 未知
                  (2) 小样本的估计
                      正态总体 / 非正态总体，小样本：
                                                  σ1 / σ2 已知 
                                                  σ1 / σ2 未知：
                                                               σ1 = σ2
                                                               σ1 ≠ σ2
                                                                
    【2】匹配样本  (1) 大样本的估计   μd = μ1 - μ2  σd：各差值标准差
                                                                  总体 σd 已知
                                                                  总体 σd 未知
                  (2) 小样本的估计   
                                  总体σd 未知
                      
                   
   总体均值之差  `π1 - π2`：    
      
      大样本    
                总体比例 π1 / π2 已知
                总体比例 π1 / π2 未知
   
   总体方差比   `σ1^2 / σ2^2`：      
   
      F(1-α/2) ≤ F ≤  F(α/2)    (s1^2/σ1^2) / (s2^2/σ2^2) ~ F(n1-1,n2-1)   

#### 7.4 样本量的确定

   给定`估计误差` / `Z(α/2)` / `总体标准差`，可以推导出所需样本量。


------------------------------


   
 **8. `[ 假设检验 ]`**    
------------------------------

  假设检验 = 参数估计 + 假设检验

#### 8.1 假设检验的基本问题

   `H0：`原假设  `H1：`备择假设   
   
    第 Ⅰ 类错误：H0 为真被拒绝   α 错误          第 Ⅱ 类错误：H0 为假被接受   β 错误
    
   相同的样本量 `n`，`α`增大 `β`减小，`α`减小 `β`增大。
   
   增大样本量 `n`，`α` 和 `β`同时减小。
   
    临界值向右移动，α 减小 β 增大。
    临界值向左移动，α 增大 β 减小。
   
   假设检验的流程：
   
    提出原假设和备择假设
    样本量大或小，总体标准 σ 已知或未知（检验统计量）
    z = (x - μ0) /  σ/√￣(n)   |z| > |z(α/2)| 拒绝H0
    
   P值：原假设为真时，样本观察结果或更极端的概率。
   
   双侧检验，`P < 0.025` 拒绝原假设；单侧检验，`P < 0.05` 拒绝原假设。
    
 #### 8.2 一个总体参数的检验
 
  统计量：`z` 统计量 / `t` 统计量 / `x^2` 统计量
  
    【1】 样本量：样本量大，σ 已知     样本量大，σ 未知
    【2】 总体标准差 σ：样本量小，σ 已知    样本量小， σ 未知
    
     n > 30时，z 分布        n < 30时，σ 未知，t 分布
   
   总体均值的检验：
             
    样本量大，σ 未知
    样本量小，σ 已知
    样本量小，σ 未知
   
   总体比例的检验：
   
     样本量大，np > 5，n(1-p) > 5，二项分布正态近似   
   
   总体方差的检验：
     
     (n-1)s^2/σ^2 ~ X^2(n-1) 
     
                  
 #### 8.3 两个总体参数的检验
 
   统计量：`z` 统计量 / `t` 统计量 / `F` 统计量
   
    【1】 总体标准差 σ1，σ2：已知，z 检验    未知，t 检验
    【2】 样本量 n1，n2：样本量大，z 检验   样本量小，t 检验
   
   两个总体均值之差：
   
     独立，样本量大，σ1 σ2 已知
     独立，样本量小，σ1 σ2 未知：
                                σ1 = σ2
                                σ1 ≠ σ2
                                
   两个总体比例之差：
   
     检验两个总体比例相等
     检验两个总体比例不相等
   
   两个总体方差比：
   
       (s1^2/σ1^2) / (s2^2/σ2^2) ~ F(n1-1,n2-1)   
       
   检验中的匹配样本：
   
     小样本，σ1 和 σ2 未知
     在相同条件下做不同的事
     
     
  #### 8.4 检验问题的进一步说明
  
   接受`H0`：在显著水平 α 下没有发现充足的证据反对 `H0`
   
   原假设：传统的观点    
   
   备择假设：希望证明的命题
                                

------------------------------


   
 **9. `[ 分类数据分析 ]`**    
------------------------------


#### 9.1 分类数据与 x^2 统计量

   对更多的总体比例进行比较        
   
   拟合优度检验 / 独立性检验
   
   x^2检验：对分类数据的频数进行分析 (两个分类变量之间的相关程度)
   
     x^2 = ∑[(fo - fe)^2/fe]  fo：观察值频数  fe：期望值频数
     
      
#### 9.2 拟合优度检验

    H0：观察频数与期望频数一致
    H1：观察频数与期望频数不一致
   
   计算 `x^2 = ∑[(fo - fe)^2/fe]`  自由度：`df = R - 1`  R：分类变量类型的个数 
   
     总体比例检验：针对二项分布问题
     x^2 统计量：针对二项分布 / 多项分布问题
   

#### 9.3 列联分析：独立性检验

   拟合优度检验：一个分类变量的检验
   
   独立性检验：两个分类变量的检验
   
   列联表：行 (R) 列(C) R * C 

     H0：行变量与列变量是独立的
     H1：行变量与列变量不是独立的
     
     p(行变量，列变量) = p(样本来自行变量) * p(样本来自列变量)
     fe = RT/n * CT/n * n = RT * CT / n    自由度：(R-1)(C-1)
     

#### 9.4 列联表中的相关测量

   变量如果存在联系，相关程度多大
   
   φ 相关系数：
     
     φ = √￣(x^2 / n)  n：总频数
     φ = (ad - bc) / √￣((a+b)(c+d)(a+c)(b+d))            ad= bc，相关独立     b=0，c=0，φ=1，完全相关  a=0，d=0，φ=-1，完全相关
     2 * 2 列联表可以把 φ 控制在 [0,1]，φ 越大，相关系数越大。
   
   相关系数：
   
     R * C 列联表  R或C大于2
     c = √￣(x^2 / x^2 + n)    相互独立，c=0    R与C越大，c越大，但小于1
     
   V 相关系数：
      
     V = √￣(x^2 / n * min[(R-1)，(C-1)])
     相互独立，V = 0     完全相关，V = 1    取值范围 [0,1]
     行变量或列变量为2，V = φ

   数值分析：
   
     进行独立性检验，存在相关性。计算 φ 系数，c 系数，V 系数。
     
 #### 9.5 列联分析中应注意的问题

   条件百分表的方向：`列变量X (自变量)`  `行变量Y (因变量)`
   
   x^2 分布的期望值准则：样本量必须足够大
     
     (1) 如果只有两个单元，每个单元期望频数 ≥ 5
     (2) 如果两个以上单元，20% 单元期望频数 < 5，不能应用 x^2 检验
     
     期望频数 fe 过小，(fo - fe)^2 / fe 变大，造成 x^2 的高估，从而可能拒绝 H0
     处理方法：将较小的 fe 合并


------------------------------


   
 **10. `[ 方差分析 ]`**    
------------------------------

 #### 10.1 方差分析引论

   比较多个总体的均值是否相等  `分类型自变量`  `数值型因变量`
   
     因素 / 因子：分类自变量
     水平 / 处理：分类自变量类别
   
     组内误差：样本内部数据的离散程度
     组间误差：不同样本之间数据的离散程度
     
     SST：误差平方和    SSE：组内平方和 (残差平方和)    SSA：组间平方和 (因素平方和)
                            随机误差                       随机误差 + 系统误差
     
   基本假定：
   
     (1) 每个总体服从正态分布
     (2) 每个总体的 σ^2 相同
     (3) 观测值是独立的
     
   设因素有 `k` 个水平，每个水平均值 μ1，μ2，....，μk
     
     H0：μ1 = μ2 = .... = μk     自变量对因变量没有显著影响
     H1：μ1，μ2，....，μk不全相等 自变量对因变量有显著影响
   
 
  #### 10.2 单因素方差分析

   只涉及一个分类型变量
     
     因素的 k 个水平：A1 A2.... A3
     观测值 xij：第 i 个水平和第 j 个观测值
   
     SST = SSA + SSE   SSA：因子效应    SSE：残差效应
     SST 自由度：n-1   SSA 自由度：k-1   SSE 自由度：n-k
     
     MSA = SSA / k-1   MSE = SSE / n-k    F = MSA / MSE ~ F(k-1，n-k)
     F > Fa(k-1，n-k)  拒绝原假设
     F < Fa(k-1，n-k)  没有证据拒绝原假设
     
   关系强度测量：
    
     R^2 = SSA / SST    R：自变量与因变量之间的关系强度
   
   多重比较方法：
     
     接受备择假设，判断哪两个均值不同
     (1) 提出假设      H0：μi = μj   H1：μi ≠ μj
     (2) 检验统计量    xi均 - xj均
     (3) 计算LSD       LSD =  t(α/2) *  √￣(MSE * (1 / ni + 1 / nj))         t(α/2) 自由度：n-k
                      |xi - xj| > LSD，拒绝H0
           
     
  
  #### 10.3 双因素方差分析

   涉及两个分类型变量
     
     相互独立：无重复双因素         交互作用：可重复双因素        
   
   无交互作用的双因素方差分析
   
     k：行变量的水平数     r：列变量的水平数
     
     (1) 提出假设    
                    行因素    
                           H0：μ1 = μ2 = .... = μk   行因素对因变量没有显著影响
                           H1：μi 不全相等            行因素对因变量有显著影响                           
                    行因素    
                           H0：μ1 = μ2 = .... = μr   列因素对因变量没有显著影响
                           H1：μj 不全相等            列因素对因变量有显著影响      
                           
     (2) 构造检验统计量        
                           SST 自由度 kr-1   SSR 自由度 k-1   SSC 自由度 r-1    SSE 自由度 (k-1)(r-1)
                           SST = SSR + SSC + SSE   (行因素误差平方和 + 列因素误差平方和 + 随机误差平方和)
                           
                           MSR = SSR / k-1   MSC = SSC / r-1   MSE = SSE / (k-1)(r-1)
                           FR = MSR / MSE ~ F(k-1，(k-1)(r-1))       Fc = MSC / MSE ~ F(r-1，(k-1)(r-1))
                           
     (3) 统计决策    FR > Fa，拒绝 H0     Fc > Fa，拒绝 H0                  
      
     关系强度的测量：两个自变量与因变量之间的关系强度    R^2 = (SSR + SSC) / SST
   
   
   有交互作用的双因素方差分析
     
     k：行变量的水平数     r：列变量的水平数      m：行变量每个水平的行数
     SST  自由度 krm-1    SSR  自由度 k-1       SSC  自由度  r-1        SSRC  自由度  (k-1)(r-1)       SSE  自由度  kr(m-1)
     SST = SSR + SSC + SSRC + SSE    (行变量平方和 + 列变量平方和 + 交互作用平方和 + 误差平方和)
     
     MSR = SSR / k-1     MSC = SSC / r-1    MSRC = SSRC / (k-1)(r-1)    MSE = SSE / kr(m-1)
     FR = MSR / MSE      Fc = MSC / MSE     FRc = MSRC / MSE
     
------------------------------




 **11. `[ 一元线性回归 ]`**    
------------------------------

 #### 11.1 变量间关系的度量

   数值型自变量与数值型因变量
   
   相关与回归分析
   
     两个变量：一元    两个以上变量：多元
     相关关系：变量之间存在不确定的数量关系
     
   相关分析对总体的假设：    
   
     (1) 两个变量之间是线性关系
     (2) 两个变量都是随机变量
     
   散点图：
   
     线性相关(正相关 / 负相关)   非线性相关   不相关
     
   相关系数：
   
     总体相关系数 ρ     样本相关系数 r
     r ∈ [-1,1]    r = 0，线性不相关     r ∈ (0,1]，正相关    r ∈ [-1,0)，负相关
                   r = 1，完全正相关     r = -1，完全负相关
 
     r = 0 可能存在非线性关系，不能说明没有关系。
     |r| → 1，线性关系强     |r| → 0，线性关系弱
     |r| ≥ 0.8，高度相关     0.5 ≤ |r| < 0.8，中度相关      0.3 ≤ |r| < 0.5，低度相关     |r| < 0.3，不相关
   
   显著性检验：
   
     假设 r 为正态分布，采用 t 分布。
     (1) 提出假设：      H0：ρ = 0      H1：ρ ≠ 0
     (2) 计算统计量：    t = |r| * √￣((n-2) / (1-r^2)) ~  t(n-2)
     (3) 决策：         |t| > t(α/2)，拒绝原假设。
     
  #### 11.2 一元线性回归

   相关分析：变量之间的关系强度    
   
   回归分析：变量之间的数量关系
   
   回归模型：
     
     y：因变量  x：自变量     y = β0 + β1x + ε (ε：误差项)
     (1) y 与 x 具有线性关系
     (2) x 的取值固定
     (3) E(y) = β0 + β1x    E(β0) = β0     E(β1) = β1
     (4) ε ~ N(0,σ^2)  y ~ N(β0 + β1x,σ^2)
     
   回归方程：
     
     E(y) = β0 + β1x
     β0 与 β1 未知，用 β0^ 和 β1^ 估计。
     估计回归方程：y^ = β0^ + β1^x
     
   最小二乘法估计：
     
     yi^ = β0^ + β1^xi     ∑(yi - yi^)^2 = ∑(yi - β0^ - β1^xi)^2 最小
     同时对 β0^ 和 β1^ 求偏导       回归直线经过点(x均，y均)
     
   回归直线的拟合优度：回归直线与各观测点的接近程度
     
     (1) 判定系数
         SST = ∑(yi - yi均)^2 = ∑(yi - yi^ + yi^ - yi均)^2
             = ∑(yi - yi^)^2 + ∑(yi^ - yi均)^2
                   SSE              SSR
         总平方和 (SST) = 回归平方和 (SSR) + 残差平方和 (SSE)
         R^2 = SSR / SST = 1 - SSE / SST
         R^2 ∈ [0,1]    R^2 → 1，拟合好     R^2 → 0，拟合差
      
     (2) 估计标准误差
         判定系数 → 拟合程度   残差平方和 → 差异程度
         se = √￣(SSE / (n-2)) = √￣(MSE)    se → 0，误差越小。
  
   显著性检验：
   
     (1) 线性关系
         SSR 自由度：自变量个数 k
         SSE 自由度：自变量个数 n-k-1
   
     
     
     
     
  
        
          
     


